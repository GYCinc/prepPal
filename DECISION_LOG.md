### 2024-07-30: AI Model Upgrade - Dedicated Search Grounding Function

*   **Type:** `Architectural Decision`
*   **Context:** The user requested an upgrade to the AI model, specifically "latest Gemini 2.5 flash thinking latest search for it." The existing `generateText` function in `services/geminiService.ts` already implements "thinking" for `gemini-2.5-flash` and is used for creative sentence generation and explanation, not factual lookup. Integrating `googleSearch` directly into `generateText` for these use cases would violate `@google/genai` guidelines (which specify `googleSearch` for "recent events, news, or up-to-date information") and introduce unnecessary complexity (latency, cost, mandatory UI for grounding URLs) to a language learning app.
*   **Decision/Outcome:** A new service function, `generateSearchGroundedText`, was created in `services/geminiService.ts`. This function is specifically designed to leverage `googleSearch` grounding with `gemini-2.5-flash` (including `thinkingConfig`) and correctly extracts `groundingUrls` as per guidelines. The existing `generateText` function remains unchanged to maintain its purpose for creative text generation without search.
*   **Rationale:** This approach satisfies the user's request to enable "search" capability for the AI model while adhering strictly to `@google/genai` guidelines for `googleSearch` usage. It separates concerns, ensuring that creative text generation (`generateText`) is distinct from search-grounded factual generation (`generateSearchGroundedText`). This prevents misapplication of the `googleSearch` tool, avoids unnecessary performance overhead, and maintains the current clean architecture and user experience of `PrepositionPal`, which does not currently have features requiring search grounding in its main game loop. If future features require search-grounded content, `generateSearchGroundedText` can be readily integrated.

### 2024-07-30: Refined Humor Level Implementation

*   **Type:** `Feature Refinement`
*   **Context:** The application included a 'Humor Level' slider in the UI, but its effect on the AI-generated content was binary (humor was only added for levels 5 and above). The user's request was to fully implement this feature to have a more granular impact on the game's tone.
*   **Decision/Outcome:** The `buildGeminiPrompt` function in `components/PrepositionGame.tsx` was updated. The logic now interprets the full 0-10 humor scale and injects more nuanced instructions into the Gemini prompt, ranging from 'strictly factual' for low levels to 'subtly amusing' and 'witty and clever' for higher levels.
*   **Rationale:** This change fully realizes the user-facing 'Humor Level' feature. It provides users with more meaningful control over the tone of their learning experience, enhancing engagement and replayability by allowing them to tailor the game's personality to their preference.
